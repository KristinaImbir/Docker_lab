# README 

## Описание
Это проект демонстрирует создание контейнеризированного веб-приложения на базе FastAPI с использованием базы данных PostgreSQL. Приложение поддерживает миграции базы данных и предоставляет API для работы с сущностями (CRUD-операции). Проект докеризован и запускается с помощью Docker Compose.

## Установка и запуск

### Шаги для запуска:

1. Клонируйте репозиторий:
```bash
git clone <URL_репозитория>
cd <папка_проекта>
```

2. Создайте `.env` файл в корне проекта:
```bash
POSTGRES_USER=user
POSTGRES_PASSWORD=password
POSTGRES_DB=app_db
DATABASE_URL=postgresql://user:password@db:5432/app_db
```

3. Запустите контейнеры:
```bash
docker-compose up --build
```

4. Приложение будет доступно по адресу:
```bash
http://localhost:8000
```


## Особенности конфигурации

### Dockerfile:
1. Используется легковесный образ python:3.11-alpine.
2. Все зависимости устанавливаются без кэша, а временные файлы удаляются.
3. Контейнер запускается от непривилегированного пользователя appuser.

### docker-compose.yml:
1. Сервис `web`:
   - Указывает порт 8000:8000 для доступа к приложению.
   - Использует переменные окружения из файла `.env`.
   - Подключает внешний том `static_data` для статики.
   - Запускается от непривилегированного пользователя.

2. Сервис `db`:
   - Использует легковесный образ postgres:alpine.
   - Подключает том `db_data` для хранения данных PostgreSQL.
   - Переменные конфигурации берутся из `.env`.

3. Сеть `internal`:
   - Создаётся изолированная сеть internal для связи между сервисами.

## Дополнительная информация
- Миграции базы данных выполняются при старте приложения с помощью сценария run_migrations.py, который подключается к базе данных и применяет миграции из папки migrations.
- Контейнеры запускаются с использованием базовых легковесных образов Alpine для минимизации размера образа и ускорения сборки.
- Все конфигурации приложения (включая параметры базы данных) задаются через переменные окружения, что позволяет легко изменять их без необходимости пересборки контейнера.
